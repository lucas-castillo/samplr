---
title: "Simulations of the Autocorrelated Bayesian Sampler"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Simulations-of-the-Autocorrelated-Bayesian-Sampler}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette provides a brief introduction of the Autocorrelated Bayesian Sampler (ABS, Zhu et al., 2023) and the `R` scripts for running simulations of ABS using `samplr` package.

ABS is a sequential sampling model that assumes individuals draw autocorrelated samples from their memory of hypotheses based on their posterior beliefs. These samples are subsequently integrated to perform various tasks: ABS is capable of generating estimates, confidence intervals, and response times for estimation tasks, as well as choices, confidence judgments, and response times for two-alternative force choice tasks. In this vignette, we will outline the process of simulating both types of tasks using ABS.

## Estimation task

Estimation tasks involve participants providing estimates, such as the number of stimuli (e.g., dots) on a screen or offering confidence intervals of that counts at a specified level.

In this vignette, we will begin by generating several random numbers to represent the stimuli counts. We'll assume the estimation task consists of 10 trials, wherein participants are tasked with estimating the number of dots displayed on the screen in each trial.

```{r setup}
require(samplr)

set.seed(2024)
stim <- sample(20:25, 10, replace=TRUE)
```

ABS employs [R6][R6::R6Class] object-oriented programming (OOP) system. Thus we need to construct a new object before running simulations. In the initialising step, we need to provide the values of five parameters:

-   the proposal width of the MC3 sampler, `width`;
-   the number of chains of the MC3 sampler, `n_chains`;
-   the lower bound of the non-decision time, `nd_time`;
-   the variability of the non-decision time, `s_nd_time`;
- the lambda of the Erlang distribution for the response time, `lambda`.

```{r}
abs_model <- Zhu23ABS$new(width=1, n_chains = 3, nd_time = 0.3, s_nd_time = 0.2, lambda = 10)
```

As we are going to use ABS to simulate a estimation task, we need to call the method `estimate` with further two arguments:

-   the absolute stop rule, `n_sample`;
-   the stimuli of the estimate task, `trial_stim`;

```{r}
est_sim <- abs_model$estimate(n_sample = 5, trial_stim = stim)
```

The table below presents the samples, response times, and point estimations generated by ABS. It's important to note that ABS assumes the response time for each trial follows an Erlang distribution, with the shape parameter equal to the length of the samples. The response time value provided in the table is a random number drawn from the Erlang distribution.

```{r}
knitr::kable(est_sim)
```

In addition to point estimation, ABS can also simulate confidence interval estimation by specifying the desired confidence level in the `estimate` method.

```{r}
interval_sim <- abs_model$estimate(n_sample = 5, trial_stim = stim, conf_level = 0.5)
```

The following table shows the interval estimation on the level of 0.5. `conf_interval_l` and `conf_interval_u` represent the lower and the upper bounds.

```{r}
knitr::kable(interval_sim)
```
```
